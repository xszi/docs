# å¯è§†åŒ–çš„JavaScript â€”â€” ï¼ˆä¸ƒï¼‰Promises å’Œ Async/Awaitã€6.12ã€‘

ã€ä¸ƒã€‘[JavaScript Visualized: Promises & Async/Await](https://dev.to/lydiahallie/javascript-visualized-promises-async-await-5gke)

æ˜¯å¦æ›¾ç»å› ä¸ºä»£ç æ²¡æœ‰æŒ‰ç…§æ‚¨é¢„æœŸçš„æ–¹å¼è¿è¡Œï¼Œè€Œä¸å¾—ä¸å¯¹**JS** ä»£ç è¿›è¡Œå¤„ç† ã€‚å‡½æ•°ä¼¼ä¹æ˜¯åœ¨éšæœºã€ä¸å¯é¢„æµ‹çš„æ—¶é—´æ‰§è¡Œçš„ï¼Œæˆ–è€…æ‰§è¡Œè¢«å»¶è¿Ÿäº†ã€‚æ‚¨å¯èƒ½æ­£åœ¨ä½¿ç”¨ **ES6** å¼•å…¥çš„ä¸€ä¸ªå¾ˆé…·çš„æ–°åŠŸèƒ½ï¼š**Promises**ï¼

æˆ‘å¤šå¹´å‰çš„å¥½å¥‡å¿ƒå¾—åˆ°äº†ç­”å¤ï¼Œæˆ‘çš„ä¸çœ ä¹‹å¤œå†æ¬¡è®©æˆ‘æœ‰æ—¶é—´åˆ¶ä½œä¸€äº›åŠ¨ç”»ã€‚æ˜¯æ—¶å€™è®¨è®º **Promise** äº†ï¼šä½ **ä¸ºä»€ä¹ˆ**è¦ä½¿ç”¨å®ƒä»¬ï¼Œå®ƒä»¬**å¦‚ä½•**åœ¨â€œå¹•åâ€å·¥ä½œï¼Œä»¥åŠæˆ‘ä»¬å¦‚ä½•ä»¥æœ€**ç°ä»£çš„**æ–¹å¼å®ç°å®ƒä»¬ï¼Ÿ


|       å…¨æ–‡åˆ†ä¸ºå››ä¸ªç« èŠ‚ï¼š      |
| ------------------------------ |
| ğŸ¥³ ç®€ä»‹                         |
| âš¡ï¸ Promise è¯­æ³•                 |
| â™»ï¸ äº‹ä»¶å¾ªç¯ï¼šå¾®ä»»åŠ¡å’Œï¼ˆå®ï¼‰ä»»åŠ¡ |
| ğŸš€ å¼‚æ­¥/ç­‰å¾…                    |



### ä»‹ç»

åœ¨ç¼–å†™ JavaScript æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸è¦å¤„ç†ä¾èµ–å…¶ä»–ä»»åŠ¡çš„ä»»åŠ¡ï¼å‡è®¾æˆ‘ä»¬æƒ³è¦è·å–ä¸€ä¸ªå›¾åƒï¼Œå‹ç¼©å®ƒï¼Œåº”ç”¨è¿‡æ»¤å™¨ï¼Œç„¶åä¿å­˜å®ƒğŸ“¸

æˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯*è·å–*æˆ‘ä»¬æƒ³è¦ç¼–è¾‘çš„å›¾åƒã€‚ä¸€ä¸ª`getImage`å‡½æ•°å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼åªæœ‰æˆåŠŸåŠ è½½è¯¥å›¾åƒåï¼Œæˆ‘ä»¬æ‰èƒ½å°†è¯¥å€¼ä¼ é€’ç»™`resizeImage`å‡½æ•°ã€‚æˆåŠŸè°ƒæ•´å›¾åƒå¤§å°åï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨`applyFilter`å‡½æ•°ä¸­å¯¹å›¾åƒåº”ç”¨è¿‡æ»¤å™¨ã€‚å‹ç¼©å›¾åƒå¹¶æ·»åŠ è¿‡æ»¤å™¨åï¼Œæˆ‘ä»¬è¦ä¿å­˜å›¾åƒå¹¶è®©ç”¨æˆ·çŸ¥é“ä¸€åˆ‡æ­£å¸¸ï¼ğŸ¥³

æœ€åï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°è¿™æ ·çš„ç»“æœï¼š

![img](https://res.cloudinary.com/practicaldev/image/fetch/s---Kv6sJn7--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/ixceqsql5hpdq8txx43s.png)

å—¯â€¦â€¦æ³¨æ„åˆ°è¿™é‡Œæœ‰ä»€ä¹ˆå—ï¼Ÿè™½ç„¶å®ƒâ€¦â€¦*å¾ˆå¥½*ï¼Œä½†ä¸æ˜¯å¾ˆå¥½ã€‚æˆ‘ä»¬æœ€ç»ˆå¾—åˆ°äº†è®¸å¤šä¾èµ–äºå‰ä¸€ä¸ªå›è°ƒå‡½æ•°çš„åµŒå¥—å›è°ƒå‡½æ•°ã€‚è¿™é€šå¸¸è¢«ç§°ä¸º[*å›è°ƒåœ°ç‹±*](http://callbackhell.com/)ï¼Œå› ä¸ºæˆ‘ä»¬æœ€ç»ˆä¼šå¾—åˆ°å¤§é‡åµŒå¥—çš„å›è°ƒå‡½æ•°ï¼Œè¿™ä½¿å¾—ä»£ç å¾ˆéš¾é˜…è¯»ï¼

å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸€ä¸ªå«åš**promises **çš„ä¸œè¥¿æ¥å¸®åŠ©æˆ‘ä»¬ï¼è®©æˆ‘ä»¬æ¥çœ‹çœ‹ **Promise** æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒä»¬å¦‚ä½•åœ¨è¿™æ ·çš„æƒ…å†µä¸‹å¸®åŠ©æˆ‘ä»¬ï¼ğŸ˜ƒ



###  Promise è¯­æ³•

ES6 å¼•å…¥äº†**Promise**ã€‚åœ¨è®¸å¤šæ•™ç¨‹ä¸­ï¼Œæ‚¨å°†é˜…è¯»ä»¥ä¸‹å†…å®¹ï¼š

> â€œPromiseæ˜¯ä¸€ä¸ªå€¼çš„å ä½ç¬¦ï¼Œå¯ä»¥åœ¨æœªæ¥çš„æŸä¸ªæ—¶é—´è§£å†³æˆ–æ‹’ç»â€

æ˜¯çš„...è¿™ä¸ªè§£é‡Šä»æ¥æ²¡æœ‰è®©æˆ‘æ›´æ¸…æ¥šã€‚äº‹å®ä¸Šï¼Œå®ƒåªæ˜¯è®©æˆ‘è§‰å¾— **Promise** æ˜¯ä¸€ç§å¥‡æ€ªçš„ã€æ¨¡ç³Šçš„ã€ä¸å¯é¢„æµ‹çš„é­”æ³•ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹éƒ½æœ‰å“ªäº›**Promise** ã€‚

æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª**Promise** ï¼Œä½¿ç”¨ä¸€ä¸ª`Promise`æ¥æ”¶å›è°ƒçš„æ„é€ å‡½æ•°ã€‚å¥½çš„ï¼Œè®©æˆ‘ä»¬è¯•è¯•å§ï¼

![æ›¿æ¢æ–‡å­—](https://res.cloudinary.com/practicaldev/image/fetch/s--phTVdCKA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/79zi452hphe7ecylhozy.gif)

ç­‰ç­‰ï¼Œåˆšåˆšè¿”å›äº†ä»€ä¹ˆï¼Ÿ

ä¸€ä¸ª`Promise`æ˜¯ä¸€ä¸ªåŒ…å«**çŠ¶æ€**( `[[PromiseStatus]]`) å’Œ**å€¼**( `[[PromiseValue]]`) çš„å¯¹è±¡ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼Œå€¼`[[PromiseStatus]]`çš„å€¼æ˜¯`"pending"`ï¼Œ`[[PromiseValue]]`çš„å€¼æ˜¯`undefined`ã€‚

åˆ«æ‹…å¿ƒ - ä½ æ°¸è¿œä¸å¿…ä¸è¿™ä¸ªå¯¹è±¡äº¤äº’ï¼Œä½ ç”šè‡³ä¸èƒ½è®¿é—®`[[PromiseStatus]]`å’Œ`[[PromiseValue]]`å±æ€§ï¼ä½†æ˜¯ï¼Œåœ¨ä½¿ç”¨ **Promise** æ—¶ï¼Œè¿™äº›å±æ€§çš„å€¼å¾ˆé‡è¦ã€‚

`PromiseStatus`çš„å€¼ï¼Œ**çŠ¶æ€**ï¼Œå¯ä»¥æ˜¯ä¸‰ä¸ªå€¼ä¹‹ä¸€ï¼š

- âœ… `fulfilled`ï¼šæ‰¿è¯ºå·²`resolved`ã€‚ä¸€åˆ‡é¡ºåˆ©ï¼Œ**Promise** å†…æ²¡æœ‰å‡ºç°é”™è¯¯ğŸ¥³
- âŒ `rejected`ï¼š**Promise** å·²`rejected`ã€‚å‡ºäº‹äº†..
- â³ `pending`ï¼š**promise** æ—¢æ²¡æœ‰è§£å†³ä¹Ÿæ²¡æœ‰æ‹’ç»ï¼ˆè¿˜ï¼‰ï¼Œ**promise** è¿˜æ˜¯`pending`.

è¿™ä¸€åˆ‡å¬èµ·æ¥éƒ½å¾ˆæ£’ï¼Œä½†æ˜¯ä»€ä¹ˆæ—¶å€™ **promise** çŠ¶æ€æ˜¯`"pending"`ï¼Œ`"fulfilled"`æˆ–`"rejected"`ï¼Ÿä¸ºä»€ä¹ˆè¿™ç§çŠ¶æ€å¾ˆé‡è¦ï¼Ÿ

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯å°†ç®€å•çš„å›è°ƒå‡½æ•°`() => {}`ä¼ é€’ç»™`Promise`æ„é€ å‡½æ•°ã€‚ç„¶è€Œï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°å®é™…ä¸Šæ¥æ”¶ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼ï¼Œé€šå¸¸ç§°ä¸º`resolve` æˆ–è€… `res`ï¼Œæ˜¯å½“ `Promise ` **resolve**æ—¶è¦è°ƒç”¨çš„æ–¹æ³•ã€‚ç¬¬äºŒä¸ªå‚æ•°çš„å€¼ï¼Œé€šå¸¸ç§°ä¸º`reject`æˆ–è€… `rej`ï¼Œæ˜¯å½“ `Promise ` **reject**æ—¶è¦è°ƒç”¨çš„å€¼æ–¹æ³•ï¼Œæ­¤æ—¶å‡ºç°äº†é—®é¢˜ã€‚

![img](https://res.cloudinary.com/practicaldev/image/fetch/s--9A_mOYMP--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/duen4peq0bdr55cka5ya.png)

è®©æˆ‘ä»¬è¯•ç€çœ‹çœ‹å½“æˆ‘ä»¬è°ƒç”¨`resolve `æˆ–`reject`æ–¹æ³•æ—¶ä¼šè¢«è®°å½•ä¸‹æ¥ï¼åœ¨æˆ‘çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘è°ƒç”¨äº†`resolve`æ–¹æ³•`res`å’Œ`reject`æ–¹æ³• `rej`ã€‚

![img](https://res.cloudinary.com/practicaldev/image/fetch/s--qKIq-sYt--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/z0b9v0h7aiq073l5tl2l.gif)

æˆ‘ä»¬ç»ˆäºçŸ¥é“å¦‚ä½•æ‘†è„±`"pending"`çŠ¶æ€å’Œ`undefined`å€¼äº†ï¼å¦‚æœæˆ‘ä»¬è°ƒç”¨äº†`resolve`æ–¹æ³•ï¼Œ**promise**çš„**çŠ¶æ€**æ˜¯`"fulfilled"`ï¼Œå¦‚æœæˆ‘ä»¬è°ƒç”¨äº†`rejecte`æ–¹æ³•ï¼Œ**promise**çš„çŠ¶æ€æ˜¯`"rejected`"ã€‚

**promise**çš„å€¼ï¼Œ`[[PromiseValue]]`ï¼Œæ˜¯æˆ‘ä»¬ä½œä¸ºå‚æ•°ä¼ é€’ç»™`resolved`æˆ–`rejected`æ–¹æ³•çš„ã€‚

>æœ‰è¶£çš„äº‹å®ï¼Œæˆ‘è®© Jake Archibald æ ¡å¯¹äº†è¿™ç¯‡æ–‡ç« ï¼Œä»–å®é™…ä¸ŠæŒ‡å‡º Chrome ä¸­å­˜åœ¨ä¸€ä¸ªé”™è¯¯ï¼Œå½“å‰æ˜¾ç¤ºçŠ¶æ€ä¸º`"resolved"`è€Œä¸æ˜¯`"fulfilled"`ã€‚æ„Ÿè°¢[Mathias Bynensï¼Œ](https://twitter.com/mathias)å®ƒç°åœ¨å·²åœ¨ Canary ä¸­ä¿®å¤ï¼ğŸ¥³ğŸ•ºğŸ¼

![unknown tweet media content](https://res.cloudinary.com/practicaldev/image/fetch/s--kZ3BKUHA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://pbs.twimg.com/media/EVJqgKLUwAEocsG.png)

å¥½çš„ï¼Œç°åœ¨æˆ‘ä»¬å¯¹å¦‚ä½•æ§åˆ¶é‚£ä¸ªæ¨¡ç³Šçš„`Promise`å¯¹è±¡æœ‰äº†æ›´å¥½çš„äº†è§£ã€‚ä½†æ˜¯å®ƒæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ

åœ¨ä»‹ç»éƒ¨åˆ†ä¸­ï¼Œæˆ‘å±•ç¤ºäº†ä¸€ä¸ªç¤ºä¾‹ï¼Œå…¶ä¸­æˆ‘ä»¬è·å–å›¾åƒã€å‹ç¼©å®ƒã€åº”ç”¨æ–‡ä»¶ç®¡ç†å™¨å¹¶ä¿å­˜å®ƒï¼æœ€ç»ˆï¼Œè¿™æœ€ç»ˆæˆä¸ºä¸€ä¸ªåµŒå¥—çš„å›è°ƒæ··ä¹±ã€‚

å¹¸è¿çš„æ˜¯ï¼Œ**Promise** å¯ä»¥å¸®åŠ©æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ï¼é¦–å…ˆï¼Œè®©æˆ‘ä»¬é‡å†™æ•´ä¸ªä»£ç å—ï¼Œè®©æ¯ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ª`Promise`ã€‚

å¦‚æœå›¾åƒå·²åŠ è½½å¹¶ä¸”ä¸€åˆ‡æ­£å¸¸ï¼Œæˆ‘ä»¬ç”¨åŠ è½½çš„å›¾åƒè§£å†³**Promise** ï¼å¦åˆ™ï¼Œå¦‚æœåŠ è½½æ–‡ä»¶æ—¶æŸå¤„å‡ºç°é”™è¯¯ï¼Œæˆ‘ä»¬**æ‹’ç»**å‘ç”Ÿé”™è¯¯çš„**Promise** ã€‚

![img](https://res.cloudinary.com/practicaldev/image/fetch/s--r9xngcNz--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/iebp0rzfnfqsrmmjplme.png)

è®©æˆ‘ä»¬çœ‹çœ‹å½“æˆ‘ä»¬åœ¨ç»ˆç«¯ä¸­è¿è¡Œå®ƒæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼

![img](https://res.cloudinary.com/practicaldev/image/fetch/s--uERkfSWf--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/wsu5nn26dp4elcwh764m.gif)

æ­£å¦‚æˆ‘ä»¬é¢„æœŸçš„é‚£æ ·ï¼Œä¸€ä¸ªå¸¦æœ‰è§£ææ•°æ®å€¼çš„**Promise** è¢«è¿”å›ã€‚

ä½†æ˜¯â€¦â€¦ç°åœ¨æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬ä¸å…³å¿ƒæ•´ä¸ª **Promise** å¯¹è±¡ï¼Œæˆ‘ä»¬åªå…³å¿ƒæ•°æ®çš„å€¼ï¼å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€äº›å†…ç½®æ–¹æ³•å¯ä»¥è·å– **promise** çš„å€¼ã€‚å¯¹äº promiseï¼Œæˆ‘ä»¬å¯ä»¥é™„åŠ  3 ä¸ªæ–¹æ³•ï¼š

- `.then()`ï¼šåœ¨**promise** è§£å†³åè¢«è°ƒç”¨ã€‚
- `.catch()`ï¼šåœ¨**promise** è¢«æ‹’ç»*è¢«è°ƒç”¨ã€‚
- `.finally()`ï¼š*æ€»æ˜¯*è¢«è°ƒç”¨ï¼Œæ— è®º**promise** å·²è§£å†³è¿˜æ˜¯è¢«æ‹’ç»ã€‚

![img](https://res.cloudinary.com/practicaldev/image/fetch/s--19tIvFJQ--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/mu1aqqnyfjsfon5hwrtw.png)

è¯¥`.then`æ–¹æ³•æ¥æ”¶ä¼ é€’è¯¥`resolve`æ–¹æ³•çš„å€¼ã€‚

![img](https://res.cloudinary.com/practicaldev/image/fetch/s--DZld0c-0--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/11vxhn9cun7stpjbdi80.gif)

è¯¥`.catch`æ–¹æ³•æ¥æ”¶ä¼ é€’`rejected`æ–¹æ³•çš„å€¼

![img](https://res.cloudinary.com/practicaldev/image/fetch/s--e9SZHcPk--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/v5y24jz4u89flazvdyn4.gif)

æœ€åï¼Œæˆ‘ä»¬æœ‰äº†ç”± **Promise** è§£æçš„å€¼ï¼Œè€Œæ²¡æœ‰æ•´ä¸ª **Promise** å¯¹è±¡ï¼æˆ‘ä»¬ç°åœ¨å¯ä»¥ç”¨è¿™ä¸ªå€¼åšä»»ä½•æˆ‘ä»¬æƒ³åšçš„äº‹æƒ…ã€‚

å½“æ‚¨çŸ¥é“**Promise** å°†å§‹ç»ˆè§£å†³æˆ–å§‹ç»ˆæ‹’ç»æ—¶ï¼Œæ‚¨å¯ä»¥ç¼–å†™`Promise.resolve`æˆ–`Promise.reject`ï¼Œä½¿ç”¨æ‚¨æƒ³è¦æ‹’ç»æˆ–è§£å†³**Promise** çš„å€¼ï¼

![Alt Text](https://res.cloudinary.com/practicaldev/image/fetch/s--61Gva3Ze--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/90hxwjfadzslvdbkr4l8.png)

ä½ ä¼šç»å¸¸åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­çœ‹åˆ°è¿™ç§è¯­æ³•ğŸ˜„

åœ¨`getImage`ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æœ€ç»ˆä¸å¾—ä¸åµŒå¥—å¤šä¸ªå›è°ƒä»¥è¿è¡Œå®ƒä»¬ã€‚å¹¸è¿çš„æ˜¯ï¼Œ`.then`å¤„ç†ç¨‹åºå¯ä»¥å¸®åŠ©æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ï¼ğŸ¥³

`.then`æœ¬èº«çš„ç»“æœæ˜¯ä¸€ä¸ª**Promise** å€¼ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦é“¾æ¥ä»»æ„æ•°é‡çš„`.then`ï¼šå‰ä¸€ä¸ª`then`å›è°ƒçš„ç»“æœå°†ä½œä¸ºå‚æ•°ä¼ é€’ç»™ä¸‹ä¸€ä¸ª`then`å›è°ƒï¼

![img](https://res.cloudinary.com/practicaldev/image/fetch/s--X8h-NDc2--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/i6busbetmoya9vny2eku.png)

åœ¨`getImage`ç¤ºä¾‹çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é“¾æ¥å¤šä¸ª`then`å›è°ƒï¼Œä»¥ä¾¿å°†å¤„ç†åçš„å›¾åƒä¼ é€’ç»™ä¸‹ä¸€ä¸ªå‡½æ•°ï¼æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªå¹²å‡€çš„`then`é“¾ï¼Œè€Œä¸æ˜¯ä»¥è®¸å¤šåµŒå¥—çš„å›è°ƒç»“æŸã€‚

![img](https://res.cloudinary.com/practicaldev/image/fetch/s--e1nVrqe1--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/u9l3lxwxlxgv2edv79xh.png)

è¿™ç§è¯­æ³•çœ‹èµ·æ¥æ¯”åµŒå¥—å›è°ƒæ›´å¥½ã€‚

### å¾®ä»»åŠ¡å’Œï¼ˆå®ï¼‰ä»»åŠ¡

ç°åœ¨æˆ‘ä»¬å¯¹å¦‚ä½•åˆ›å»º**Promise** ä»¥åŠå¦‚ä½•ä»**Promise** ä¸­æå–å€¼æœ‰äº†æ›´å¥½çš„äº†è§£ã€‚è®©æˆ‘ä»¬å‘è„šæœ¬æ·»åŠ æ›´å¤šä»£ç ï¼Œç„¶åå†æ¬¡è¿è¡Œå®ƒï¼š

![img](https://res.cloudinary.com/practicaldev/image/fetch/s--uNG7sXon--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/ey4ubnv5yjgi6hbh97xq.gif)

ç­‰ç­‰ï¼Œæˆ‘ä»¬çœ‹å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

é¦–å…ˆï¼Œ`Start!`ç™»å½•ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ç¬¬ä¸€è¡Œè®°å½•ï¼š`console.log('Start!')`ï¼ä½†æ˜¯ï¼Œè®°å½•çš„ç¬¬äºŒä¸ªå€¼æ˜¯`End!`ï¼Œè€Œ*ä¸æ˜¯*å·²è§£å†³çš„**Promise** çš„å€¼ï¼åªæœ‰åœ¨`End!`è¢«è®°å½•ä¹‹åï¼Œ**Promise** çš„å€¼æ‰ä¼šè¢«è®°å½•ã€‚è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

æˆ‘ä»¬ç»ˆäºçœ‹åˆ°äº† **Promise** çš„çœŸæ­£åŠ›é‡ï¼ğŸš€ è™½ç„¶ JavaScript æ˜¯å•çº¿ç¨‹çš„ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`Promise`æ·»åŠ å¼‚æ­¥è¡Œä¸ºã€‚

æˆ‘ä»¬ä»¥å‰æ²¡è§è¿‡å—ï¼ŸğŸ¤” åœ¨[JavaScript äº‹ä»¶å¾ªç¯ä¸­](https://dev.to/lydiahallie/javascript-visualized-event-loop-3dif)ï¼Œæˆ‘ä»¬ä¸èƒ½ä¹Ÿä½¿ç”¨æµè§ˆå™¨åŸç”Ÿçš„æ–¹æ³•`setTimeout`æ¥åˆ›å»ºæŸç§å¼‚æ­¥è¡Œä¸ºå—ï¼Ÿ

æ˜¯çš„ï¼ç„¶è€Œï¼Œåœ¨äº‹ä»¶å¾ªç¯ä¸­ï¼Œå®é™…ä¸Šæœ‰ä¸¤ç§ç±»å‹çš„é˜Ÿåˆ—ï¼šï¼ˆ**å®ï¼‰ä»»åŠ¡é˜Ÿåˆ—**ï¼ˆæˆ–ç®€ç§°ä¸º**ä»»åŠ¡é˜Ÿåˆ—**ï¼‰å’Œ **å¾®ä»»åŠ¡é˜Ÿåˆ—**ã€‚**ï¼ˆå®ï¼‰ä»»åŠ¡é˜Ÿåˆ—**  ç”¨äº**ï¼ˆå®ï¼‰ä»»åŠ¡**ï¼Œ**å¾®ä»»åŠ¡**é˜Ÿåˆ— ç”¨äº **å¾®ä»»åŠ¡**ã€‚

é‚£ä¹ˆä»€ä¹ˆæ˜¯**ï¼ˆå®ï¼‰ä»»åŠ¡**ï¼Œä»€ä¹ˆæ˜¯**å¾®**ä»»åŠ¡ï¼Ÿè™½ç„¶æœ‰ä¸€äº›æ–‡ç« æ¯”æˆ‘åœ¨è¿™é‡Œä»‹ç»çš„è¦å¤šï¼Œä½†æœ€å¸¸è§çš„å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼

|      /      |                          ä¸¾ä¾‹                           |
| ---------- | ------------------------------------------------------- |
| ï¼ˆå®ï¼‰ä»»åŠ¡   | `setTimeout`, `setInterval`,`setImmediate`              |
| å¾®ä»»åŠ¡      | `process.nextTick`, `Promise callback`,`queueMicrotask` |

æˆ‘ä»¬åœ¨å¾®ä»»åŠ¡åˆ—è¡¨ä¸­çœ‹åˆ°`Promise`äº†ï¼ğŸ˜ƒ å½“ ä¸€ä¸ª`Promise`è§£æå¹¶è°ƒç”¨å®ƒçš„`then()`, `catch()`æˆ– `finally()` æ–¹æ³•æ—¶ï¼Œè¯¥æ–¹æ³•ä¸­çš„å›è°ƒä¼šè¢«æ·»åŠ åˆ°**å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­**ï¼è¿™æ„å‘³ç€`then()`, `catch()`æˆ–`finally()`æ–¹æ³•ä¸­çš„å›è°ƒä¸ä¼šç«‹å³æ‰§è¡Œï¼Œå®è´¨ä¸Šæ˜¯å‘æˆ‘ä»¬çš„ JavaScript ä»£ç æ·»åŠ äº†ä¸€äº›å¼‚æ­¥è¡Œä¸ºï¼

æ‰€ä»¥ï¼Œä»€ä¹ˆæ—¶å€™`then()`ï¼Œ`catch()`æˆ–è€…`finally()`å›è°ƒæ‰§è¡Œï¼Ÿäº‹ä»¶å¾ªç¯ä¸ºä»»åŠ¡èµ‹äºˆä¸åŒçš„ä¼˜å…ˆçº§ï¼š

1. å½“å‰åœ¨**è°ƒç”¨å †æ ˆ**ä¸­çš„æ‰€æœ‰å‡½æ•°éƒ½è¢«æ‰§è¡Œã€‚å½“å®ƒä»¬è¿”å›ä¸€ä¸ªå€¼æ—¶ï¼Œå®ƒä»¬ä¼šä»å †æ ˆä¸­å¼¹å‡ºã€‚
2. å½“è°ƒç”¨æ ˆä¸ºç©ºæ—¶ï¼Œ*æ‰€æœ‰*æ’é˜Ÿçš„**å¾®ä»»åŠ¡**éƒ½è¢«ä¸€ä¸ªä¸€ä¸ªçš„å¼¹å‡ºåˆ°è°ƒç”¨æ ˆä¸­ï¼Œå¹¶è¢«æ‰§è¡Œï¼ï¼ˆå¾®ä»»åŠ¡æœ¬èº«ä¹Ÿå¯ä»¥è¿”å›æ–°çš„å¾®ä»»åŠ¡ï¼Œæœ‰æ•ˆåœ°åˆ›å»ºäº†ä¸€ä¸ªæ— é™çš„å¾®ä»»åŠ¡å¾ªç¯ğŸ˜¬ï¼‰
3. å¦‚æœè°ƒç”¨å †æ ˆå’Œå¾®ä»»åŠ¡é˜Ÿåˆ—éƒ½ä¸ºç©ºï¼Œåˆ™äº‹ä»¶å¾ªç¯æ£€æŸ¥ï¼ˆå®ï¼‰ä»»åŠ¡é˜Ÿåˆ—ä¸­æ˜¯å¦è¿˜æœ‰ä»»åŠ¡ã€‚å¦‚æœæœ‰ï¼Œä»»åŠ¡ä¼šè¢«å¼¹å‡ºåˆ°è°ƒç”¨å †æ ˆä¸Šï¼Œæ‰§è¡Œï¼Œç„¶åå¼¹å‡ºï¼

è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œç®€å•åœ°ä½¿ç”¨ï¼š

- `Task1`ï¼šç«‹å³æ·»åŠ åˆ°è°ƒç”¨å †æ ˆçš„å‡½æ•°ï¼Œä¾‹å¦‚é€šè¿‡åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ç«‹å³è°ƒç”¨å®ƒã€‚
- `Task2`, `Task3`, `Task4`: å¾®ä»»åŠ¡ï¼Œä¾‹å¦‚`Promise then`å›è°ƒï¼Œæˆ–æ·»åŠ äº†`queueMicrotask`.
- `Task5`, `Task6`: ä¸€ä¸ªï¼ˆå®ï¼‰ä»»åŠ¡ï¼Œä¾‹å¦‚ä¸€ä¸ª`setTimeout`æˆ–`setImmediate`å›è°ƒ

![img](https://res.cloudinary.com/practicaldev/image/fetch/s--05Fi8vBq--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/42eatw03fcha0e1qcrf0.gif)

é¦–å…ˆï¼Œ`Task1`è¿”å›ä¸€ä¸ªå€¼å¹¶ä»è°ƒç”¨å †æ ˆä¸­å¼¹å‡ºã€‚ç„¶åï¼Œå¼•æ“æ£€æŸ¥åœ¨å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ’é˜Ÿçš„ä»»åŠ¡ã€‚ä¸€æ—¦æ‰€æœ‰ä»»åŠ¡éƒ½è¢«æ”¾å…¥è°ƒç”¨å †æ ˆå¹¶æœ€ç»ˆå¼¹å‡ºï¼Œå¼•æ“å°±ä¼šæ£€æŸ¥ï¼ˆå®ï¼‰ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡è¢«å¼¹å‡ºåˆ°è°ƒç”¨å †æ ˆä¸­ï¼Œå¹¶åœ¨å®ƒä»¬è¿”å›å€¼æ—¶å¼¹å‡ºã€‚

è®©æˆ‘ä»¬ç”¨ä¸€äº›çœŸæ­£çš„ä»£ç æ¥ä½¿ç”¨å®ƒï¼

![img](https://res.cloudinary.com/practicaldev/image/fetch/s--fnbqqf1d--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/g61wwyi8wchk2hpzeq4u.png)

åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬æœ‰å®ä»»åŠ¡`setTimeout`å’Œå¾®ä»»åŠ¡æ‰¿è¯º`then()`å›è°ƒã€‚ä¸€æ—¦å¼•æ“åˆ°è¾¾`setTimeout`åŠŸèƒ½ã€‚è®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥åœ°è¿è¡Œè¿™æ®µä»£ç ï¼Œçœ‹çœ‹è®°å½•äº†ä»€ä¹ˆï¼

> å¿«é€Ÿå‚è€ƒ - åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œæˆ‘å°†å±•ç¤ºåƒ`console.log`,`setTimeout`å’Œ`Promise.resolve`è¢«æ·»åŠ åˆ°è°ƒç”¨å †æ ˆä¸­çš„æ–¹æ³•ã€‚å®ƒä»¬æ˜¯å†…éƒ¨æ–¹æ³•ï¼Œå®é™…ä¸Šä¸ä¼šå‡ºç°åœ¨å †æ ˆè·Ÿè¸ªä¸­ - æ‰€ä»¥å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨è°ƒè¯•å™¨å¹¶ä¸”åœ¨ä»»ä½•åœ°æ–¹éƒ½çœ‹ä¸åˆ°å®ƒä»¬ï¼Œè¯·ä¸è¦æ‹…å¿ƒï¼å®ƒåªæ˜¯ä¸ºäº†è§£é‡Šè¿™ä¸ªæ¦‚å¿µæ›´å®¹æ˜“è€Œæ— éœ€æ·»åŠ ä¸€å †æ ·æ¿ä»£ç ğŸ™‚



åœ¨ç¬¬ä¸€è¡Œï¼Œå¼•æ“é‡åˆ°`console.log()`æ–¹æ³•ã€‚å®ƒè¢«æ·»åŠ åˆ°è°ƒç”¨å †æ ˆä¸­ï¼Œä¹‹åå®ƒå°†å€¼è®°å½•`Start!`åˆ°æ§åˆ¶å°ã€‚è¯¥æ–¹æ³•ä»è°ƒç”¨å †æ ˆä¸­å¼¹å‡ºï¼Œå¼•æ“ç»§ç»­ã€‚

![img](https://res.cloudinary.com/practicaldev/image/fetch/s---Bt6DKsn--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/6cbjuexvy6z9ltk0bi18.gif)

å¼•æ“é‡åˆ°è¯¥`setTimeout`æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¢«å¼¹å‡ºåˆ°è°ƒç”¨å †æ ˆä¸­ã€‚è¯¥`setTimeout`æ–¹æ³•æ˜¯æµè§ˆå™¨æœ¬æœºçš„ï¼šå®ƒçš„å›è°ƒå‡½æ•° ( `() => console.log('In timeout')`) å°†è¢«æ·»åŠ åˆ° Web APIï¼Œç›´åˆ°è®¡æ—¶å™¨å®Œæˆã€‚å°½ç®¡æˆ‘ä»¬`0`ä¸ºè®¡æ—¶å™¨æä¾›äº†å€¼ï¼Œä½†å›è°ƒä»ç„¶é¦–å…ˆè¢«æ¨é€åˆ° Web APIï¼Œç„¶åå®ƒè¢«æ·»åŠ åˆ°**ï¼ˆå®ï¼‰ä»»åŠ¡é˜Ÿåˆ—ä¸­**ï¼š`setTimeout`æ˜¯ä¸€ä¸ªå®ä»»åŠ¡ï¼

![img](https://res.cloudinary.com/practicaldev/image/fetch/s--6NSYq-nO--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/yqoemb6f32lvovge8yrp.gif)

å¼•æ“é‡åˆ°`Promise.resolve()`æ–¹æ³•ã€‚è¯¥`Promise.resolve()`æ–¹æ³•è¢«æ·»åŠ åˆ°è°ƒç”¨å †æ ˆä¸­ï¼Œä¹‹åä½¿ç”¨ value è§£æ`Promise!`ã€‚å®ƒçš„`then`å›è°ƒå‡½æ•°è¢«æ·»åŠ åˆ°**å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­**ã€‚

![img](https://res.cloudinary.com/practicaldev/image/fetch/s--us8FF30N--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/6wxjxduh62fqt531e2rc.gif)

å¼•æ“é‡åˆ°`console.log()`æ–¹æ³•ã€‚å®ƒä¼šç«‹å³æ·»åŠ åˆ°è°ƒç”¨å †æ ˆä¸­ï¼Œç„¶åå°†å€¼è®°å½•`End!`åˆ°æ§åˆ¶å°ï¼Œä»è°ƒç”¨å †æ ˆä¸­å¼¹å‡ºï¼Œç„¶åå¼•æ“ç»§ç»­è¿è¡Œã€‚

å¼•æ“ç°åœ¨çœ‹åˆ°è°ƒç”¨å †æ ˆæ˜¯ç©ºçš„ã€‚ç”±äºè°ƒç”¨æ ˆæ˜¯ç©ºçš„ï¼Œå®ƒä¼šæ£€æŸ¥å¾®ä»»åŠ¡**é˜Ÿåˆ—ä¸­**æ˜¯å¦æœ‰æ’é˜Ÿçš„ä»»åŠ¡ï¼æ˜¯çš„ï¼Œ`Promise then`å›è°ƒæ­£åœ¨ç­‰å¾…è½®åˆ°å®ƒï¼å®ƒè¢«å¼¹å‡ºåˆ°è°ƒç”¨å †æ ˆä¸­ï¼Œä¹‹åå®ƒä¼šè®°å½•`Promise`çš„è§£æå€¼ï¼š`Promise`åœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯å­—ç¬¦ä¸²ã€‚

![](https://res.cloudinary.com/practicaldev/image/fetch/s--5iH5BNWm--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/lczn4fca41is4vpicr6w.gif)



å¼•æ“çœ‹åˆ°è°ƒç”¨å †æ ˆæ˜¯ç©ºçš„ï¼Œå› æ­¤å®ƒå°†å†æ¬¡æ£€æŸ¥å¾®ä»»åŠ¡é˜Ÿåˆ—ä»¥æŸ¥çœ‹ä»»åŠ¡æ˜¯å¦å·²æ’é˜Ÿã€‚ä¸ï¼Œå¾®ä»»åŠ¡é˜Ÿåˆ—å…¨æ˜¯ç©ºçš„ã€‚

æ˜¯æ—¶å€™æ£€æŸ¥**ï¼ˆå®ï¼‰ä»»åŠ¡é˜Ÿåˆ—äº†**ï¼š`setTimeout`å›è°ƒä»åœ¨é‚£é‡Œç­‰å¾…ï¼è¯¥`setTimeout`å›è°ƒè¢«å¼¹å‡ºåˆ°è°ƒç”¨å †æ ˆã€‚å›è°ƒå‡½æ•°è¿”å›`console.log`è®°å½•å­—ç¬¦ä¸²çš„æ–¹æ³•`"In timeout!"`ã€‚è¯¥`setTimeout`å›è°ƒå¼¹å‡ºè°ƒç”¨å †æ ˆã€‚

æœ€åï¼Œä¸€åˆ‡éƒ½å®Œæˆäº†ï¼ğŸ¥³ å†æ¥çœ‹æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„è¾“å‡ºä¾¿ä¸æ˜¯é‚£ä¹ˆå‡ºäººæ„æ–™äº†ã€‚



### å¼‚æ­¥ç­‰å¾…

ES7 å¼•å…¥äº†ä¸€ç§åœ¨ **JavaScript** ä¸­æ·»åŠ å¼‚æ­¥è¡Œä¸ºçš„æ–°æ–¹æ³•ï¼Œå¹¶ä½¿å¾—ä½¿ç”¨ **Promise** æ›´å®¹æ˜“ï¼é€šè¿‡å¼•å…¥`async`å’Œ`await`å…³é”®å­—ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºéšå¼è¿”å›**Promise** çš„**å¼‚æ­¥**å‡½æ•°ã€‚ä½†æ˜¯..æˆ‘ä»¬æ€ä¹ˆèƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼ŸğŸ˜®

æ­¤å‰ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥æ˜ç¡®åœ°åˆ›å»ºä½¿ç”¨`Promise`çš„å¯¹è±¡ï¼Œæ— è®ºæ˜¯é€šè¿‡è¾“å…¥`new Promise(() => {})`ï¼Œ`Promise.resolve`æˆ–`Promise.reject`ã€‚

æˆ‘ä»¬ç°åœ¨å¯ä»¥åˆ›å»º*éšå¼*è¿”å›å¯¹è±¡`Promise`çš„å¼‚æ­¥å‡½æ•°ï¼Œè€Œä¸æ˜¯æ˜¾å¼ä½¿ç”¨å¯¹è±¡ï¼è¿™æ„å‘³ç€æˆ‘ä»¬ä¸å†éœ€è¦è‡ªå·±ç¼–å†™ä»»ä½•`Promise`å¯¹è±¡ã€‚

![img](https://res.cloudinary.com/practicaldev/image/fetch/s--5ED_HyNC--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/72lqrcvy9lc8ehbpitd0.png)

å°½ç®¡**async**å‡½æ•°éšå¼è¿”å› **promise** çš„äº‹å®éå¸¸æ£’ï¼Œä½†`async`ä½¿ç”¨`await`å…³é”®å­—æ—¶å¯ä»¥çœ‹åˆ°å‡½æ•°çš„çœŸæ­£å¨åŠ›ï¼ä½¿ç”¨`await`å…³é”®å­—ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç­‰å¾…ed å€¼è¿”å›å·²è§£å†³çš„æ‰¿è¯ºæ—¶*æš‚åœ*å¼‚æ­¥å‡½æ•°`await`ã€‚å¦‚æœæˆ‘ä»¬æƒ³è·å¾—è¿™ä¸ªå·²è§£æçš„ **promise** çš„å€¼ï¼Œå°±åƒæˆ‘ä»¬ä¹‹å‰å¯¹`then()`å›è°ƒæ‰€åšçš„é‚£æ ·ï¼Œæˆ‘ä»¬å¯ä»¥å°†å˜é‡åˆ†é…ç»™`await`çš„ **promise** å€¼ï¼

é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥*æŒ‚èµ·*ä¸€ä¸ªå¼‚æ­¥å‡½æ•°å—ï¼Ÿå¥½å§ï¼Œå¾ˆå¥½ï¼Œä½†æ˜¯â€¦â€¦è¿™åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

è®©æˆ‘ä»¬çœ‹çœ‹å½“æˆ‘ä»¬è¿è¡Œä»¥ä¸‹ä»£ç å—æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼š

![æ›¿æ¢æ–‡å­—](https://res.cloudinary.com/practicaldev/image/fetch/s--aOWmZxnV--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/e5duygomitj9o455107a.gif)

è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

![æ›¿æ¢æ–‡å­—](https://res.cloudinary.com/practicaldev/image/fetch/s--bfscMU3t--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/d27d7xxiekczftjyic4b.gif)

é¦–å…ˆï¼Œå¼•æ“é‡åˆ°ä¸€ä¸ª`console.log`. å®ƒè¢«å¼¹å‡ºåˆ°è°ƒç”¨å †æ ˆä¸­ï¼Œç„¶å`Before function!`è¢«è®°å½•ã€‚

![æ›¿æ¢æ–‡å­—](https://res.cloudinary.com/practicaldev/image/fetch/s--wN7yFTnt--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/9wqej2269vmntfcuxs9t.gif)

ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨ async å‡½æ•°`myFunc()`ï¼Œç„¶å`myFunc`è¿è¡Œå‡½æ•°ä½“ã€‚åœ¨å‡½æ•°ä½“çš„ç¬¬ä¸€è¡Œï¼Œæˆ‘ä»¬è°ƒç”¨å¦ä¸€ä¸ª`console.log`ï¼Œè¿™æ¬¡æ˜¯è®°å½•å­—ç¬¦ä¸² `In function!`ã€‚`console.log`å°†è¢«æ·»åŠ åˆ°è°ƒç”¨å †æ ˆï¼Œè®°å½•è¯¥å€¼ï¼Œå¹¶å¾—åˆ°å¼¹å‡ºã€‚

![Alt Text](https://res.cloudinary.com/practicaldev/image/fetch/s--lX9JfreE--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/lch6lutxnl88j0durpyh.gif)

å‡½æ•°ä½“ç»§ç»­æ‰§è¡Œï¼Œè®©æˆ‘ä»¬è¿›å…¥ç¬¬äºŒè¡Œã€‚æœ€åï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ª`await`å…³é”®å­—ï¼ğŸ‰

å‘ç”Ÿçš„ç¬¬ä¸€ä»¶äº‹æ˜¯ç­‰å¾…çš„å€¼è¢«æ‰§è¡Œï¼š`one`åœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯å‡½æ•°ã€‚å®ƒè¢«å¼¹å‡ºåˆ°è°ƒç”¨å †æ ˆä¸Šï¼Œå¹¶æœ€ç»ˆè¿”å›ä¸€ä¸ªå·²è§£å†³çš„**promise** ã€‚ä¸€æ—¦**promise** è§£å†³å¹¶è¿”å›ä¸€ä¸ªå€¼`one`ï¼Œå¼•æ“å°±ä¼šé‡åˆ°`await`å…³é”®å­—ã€‚

é‡åˆ°`await`å…³é”®å­—æ—¶ï¼Œ`async`å‡½æ•°ä¼š*æš‚åœ*ã€‚âœ‹ğŸ¼ å‡½æ•°ä½“çš„æ‰§è¡Œ**è¢«æš‚åœ**ï¼Œå…¶ä½™çš„å¼‚æ­¥å‡½æ•°åœ¨*å¾®*ä»»åŠ¡ä¸­è¿è¡Œï¼Œè€Œä¸æ˜¯åœ¨å¸¸è§„ä»»åŠ¡ä¸­è¿è¡Œï¼

![æ›¿æ¢æ–‡å­—](https://res.cloudinary.com/practicaldev/image/fetch/s--UC78HoCO--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/b6l3psgewvtrtmrr60tg.gif)

ç°åœ¨å¼‚æ­¥å‡½æ•°`myFunc`åœ¨é‡åˆ°`await`å…³é”®å­—æ—¶è¢«æŒ‚èµ·ï¼Œå¼•æ“è·³å‡ºå¼‚æ­¥å‡½æ•°å¹¶ç»§ç»­åœ¨è°ƒç”¨å¼‚æ­¥å‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»£ç ï¼šåœ¨è¿™ç§æƒ…å†µä¸‹ä¸º**å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡**ï¼ğŸƒğŸ½â€â™€ï¸

![æ›¿æ¢æ–‡å­—](https://res.cloudinary.com/practicaldev/image/fetch/s--V8u36kEG--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/hlhrtuspjyrstifubdhs.gif)

æœ€åï¼Œåœ¨å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æ²¡æœ‰æ›´å¤šçš„ä»»åŠ¡è¦è¿è¡Œäº†ï¼äº‹ä»¶å¾ªç¯æ£€æŸ¥æ˜¯å¦æœ‰è¿˜æœ‰å¾®ä»»åŠ¡æ’é˜Ÿï¼šç¡®å®æœ‰ï¼`async myFunc`å‡½æ•°`one`è§£æåçš„å€¼åœ¨æ’é˜Ÿã€‚`myFunc`è¢«å¼¹å›è°ƒç”¨å †æ ˆï¼Œå¹¶åœ¨ä¹‹å‰åœæ­¢çš„åœ°æ–¹ç»§ç»­è¿è¡Œã€‚

å˜é‡`res`æœ€ç»ˆå¾—åˆ°äº†å®ƒçš„å€¼ï¼Œå³`one`è¿”å›çš„å·²è§£æ**promise**çš„å€¼ï¼åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ`console.log`è®°å½•`res`çš„å­—ç¬¦ä¸²å€¼`One!`ã€‚`One!`è®°å½•åˆ°æ§åˆ¶å°åå¹¶ä»è°ƒç”¨å †æ ˆä¸­å¼¹å‡ºï¼ğŸ˜Š

æœ€åï¼Œä¸€åˆ‡éƒ½å®Œæˆäº†ï¼æ‚¨æ˜¯å¦æ³¨æ„åˆ°`async`å‡½æ•°ä¸ **promise**çš„ `then`æœ‰ä½•ä¸åŒï¼Ÿè¯¥`await`å…³é”®å­—*æš‚åœ*çš„`async`åŠŸèƒ½ï¼Œè€Œ**promise**ä¼šä¸€ç›´å­˜åœ¨äºæˆ‘ä»¬å·²ç»ä½¿ç”¨è¿‡çš„`then`æ¥å‡†å¤‡æ‰§è¡Œï¼

ã€å®Œã€‘

