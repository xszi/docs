<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>我希望我早点认识Nginx | 行书子</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/docs/logo.png">
    <meta name="description" content="文档记录">
    
    <link rel="preload" href="/docs/assets/css/0.styles.ec62b53c.css" as="style"><link rel="preload" href="/docs/assets/js/app.7276380a.js" as="script"><link rel="preload" href="/docs/assets/js/2.d55b7ed5.js" as="script"><link rel="preload" href="/docs/assets/js/27.0e98421d.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.5f740ad3.js"><link rel="prefetch" href="/docs/assets/js/11.f54b3368.js"><link rel="prefetch" href="/docs/assets/js/12.0db641ab.js"><link rel="prefetch" href="/docs/assets/js/13.ca54d79b.js"><link rel="prefetch" href="/docs/assets/js/14.38146abb.js"><link rel="prefetch" href="/docs/assets/js/15.06fcc698.js"><link rel="prefetch" href="/docs/assets/js/16.bf2884e0.js"><link rel="prefetch" href="/docs/assets/js/17.f6ebf6e7.js"><link rel="prefetch" href="/docs/assets/js/18.58c68ed2.js"><link rel="prefetch" href="/docs/assets/js/19.bcccd12c.js"><link rel="prefetch" href="/docs/assets/js/20.6e0ba995.js"><link rel="prefetch" href="/docs/assets/js/21.dad6ea80.js"><link rel="prefetch" href="/docs/assets/js/22.dac9add9.js"><link rel="prefetch" href="/docs/assets/js/23.f3c9db08.js"><link rel="prefetch" href="/docs/assets/js/24.fded9a4f.js"><link rel="prefetch" href="/docs/assets/js/25.a02d2f79.js"><link rel="prefetch" href="/docs/assets/js/26.7ef8fd92.js"><link rel="prefetch" href="/docs/assets/js/28.32fec771.js"><link rel="prefetch" href="/docs/assets/js/29.a71db204.js"><link rel="prefetch" href="/docs/assets/js/3.ee451ee8.js"><link rel="prefetch" href="/docs/assets/js/30.d5838827.js"><link rel="prefetch" href="/docs/assets/js/31.d75b64c8.js"><link rel="prefetch" href="/docs/assets/js/32.f404ff45.js"><link rel="prefetch" href="/docs/assets/js/33.5e6e25fa.js"><link rel="prefetch" href="/docs/assets/js/34.5b01a07a.js"><link rel="prefetch" href="/docs/assets/js/35.d115cc5f.js"><link rel="prefetch" href="/docs/assets/js/4.77a548c8.js"><link rel="prefetch" href="/docs/assets/js/5.5fd3c55b.js"><link rel="prefetch" href="/docs/assets/js/6.706caab8.js"><link rel="prefetch" href="/docs/assets/js/7.74938af9.js"><link rel="prefetch" href="/docs/assets/js/8.b788e12b.js"><link rel="prefetch" href="/docs/assets/js/9.c179b739.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.ec62b53c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">行书子</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/xszi/javascript-algorithms" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端算法
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://xszi.github.io/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  机器学习
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://xszi.github.io/docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  感悟杂记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.github.com/xszi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/xszi/javascript-algorithms" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端算法
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://xszi.github.io/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  机器学习
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://xszi.github.io/docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  感悟杂记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.github.com/xszi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>前端译站</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/translation/category.html" class="sidebar-link">目录预览</a></li><li><a href="/docs/translation/nginx.html" aria-current="page" class="active sidebar-link">我希望我早点认识Nginx</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/translation/callstack.html" class="sidebar-link">通过两个示例来解释递归和和调用堆栈</a></li><li><a href="/docs/translation/docker.html" class="sidebar-link">通过租用办公空间例子来解释Docker容器</a></li><li><a href="/docs/translation/nodeq.html" class="sidebar-link">关于Node.js的20个面试题</a></li><li><a href="/docs/translation/float.html" class="sidebar-link">将元素浮动到底角</a></li><li><a href="/docs/translation/eventloop.html" class="sidebar-link">可视化的JavaScript —— （一）事件循环</a></li><li><a href="/docs/translation/hoisting.html" class="sidebar-link">可视化的JavaScript —— （二）提升</a></li><li><a href="/docs/translation/scope.html" class="sidebar-link">可视化的JavaScript —— （三）作用域（链）</a></li><li><a href="/docs/translation/jsengine.html" class="sidebar-link">可视化的JavaScript —— （四）JS引擎</a></li><li><a href="/docs/translation/prototype.html" class="sidebar-link">可视化的JavaScript —— （五）原型继承</a></li><li><a href="/docs/translation/geniterator.html" class="sidebar-link">可视化的JavaScript —— （六）Generators 和 Iterators</a></li><li><a href="/docs/translation/promise.html" class="sidebar-link">可视化的JavaScript —— （七）Promises 和 Async/Await</a></li><li><a href="/docs/translation/stream.html" class="sidebar-link">NodeJS 流的可视化指南</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>备忘</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/review/memo.html" class="sidebar-link">知识复习</a></li><li><a href="/docs/review/plan.html" class="sidebar-link">计划</a></li><li><a href="/docs/review/trend.html" class="sidebar-link">前端趋势</a></li><li><a href="/docs/review/question.html" class="sidebar-link">前端开发过程遇到的问题 / 建议</a></li><li><a href="/docs/review/html.html" class="sidebar-link">html备忘</a></li><li><a href="/docs/review/css.html" class="sidebar-link">css备忘</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>训练专题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/topic/sourcemap.html" class="sidebar-link">SourceMap</a></li><li><a href="/docs/topic/hmr.html" class="sidebar-link">HMR原理</a></li><li><a href="/docs/topic/algorithms.html" class="sidebar-link">算法</a></li><li><a href="/docs/topic/webpack.html" class="sidebar-link">webpack</a></li><li><a href="/docs/topic/monitor.html" class="sidebar-link">前端监控</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/typescript/intro.html" class="sidebar-link">安装 TypeScript</a></li><li><a href="/docs/typescript/install.html" class="sidebar-link">编写第一个 TypeScript 程序</a></li><li><a href="/docs/typescript/start.html" class="sidebar-link">初识 TypeScript</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="我希望我早点认识nginx"><a href="#我希望我早点认识nginx" class="header-anchor">#</a> 我希望我早点认识Nginx</h1> <p><strong>文章出处：</strong> <a href="https://dev.to/aemiej/nginx-concepts-i-wish-i-knew-years-ago-23o0" target="_blank" rel="noopener noreferrer">Nginx concepts I wish I knew years ago<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>Nginx是一种Web服务器，用来作反向代理，负载均衡，邮件代理和HTTP缓存，且遵循主从结构。</p></blockquote> <p>哇！真是一个复杂的术语，一个令人困惑的定义，里面充斥着许多令人困惑的字眼，是不是？不过不用担心，首先，我会帮助您了解Nginx中的基本体系和术语。然后，我们将继续学习Nginx的创建安装和配置。</p> <p><img src="https://user-images.githubusercontent.com/23453305/112427731-08027180-8d75-11eb-9396-e200f62fc22a.png" alt="image"></p> <p>为了使事情变得简单，只需记住：<strong>Nginx是一个了不起的Web服务器。</strong></p> <p>简单来说，Web服务器就像一个中间人。举例来说，您要访问dev.to，输入地址：https://dev.to。 浏览器会找到该地址的Web服务器，Web服务器再定位到后端服务器，后端服务器响应返回给客户端。</p> <h3 id="代理与反向代理"><a href="#代理与反向代理" class="header-anchor">#</a> 代理与反向代理</h3> <h4 id="代理"><a href="#代理" class="header-anchor">#</a> 代理</h4> <blockquote><p>也叫正向代理</p></blockquote> <p>好了，我们有客户端（&gt; = 1），中间Web服务器（可称为代理）和服务器。其中主要问题是服务器不知道哪个客户端正在请求，让我用示意图来解释。</p> <p><img src="https://user-images.githubusercontent.com/23453305/112429193-4dc03980-8d77-11eb-8bde-29df844cbc77.png" alt="image"></p> <p>这种情况下，如果client1和client2通过代理服务器将请求request1和request2发送给服务器。后端服务器会执行相关操作，但并不知道request1是由client1还是client2发送的。</p> <h4 id="反向代理"><a href="#反向代理" class="header-anchor">#</a> 反向代理</h4> <p>简单来说，反向代理与正向代理的作用相反。我们假设有一个客户端，一个中间Web服务器和几个后端服务器（&gt; = 1）。我们来看看示意图</p> <p><img src="https://user-images.githubusercontent.com/23453305/112429662-e656b980-8d77-11eb-8683-8e32abb0a7ca.png" alt="image"></p> <p>这种情况下，客户端将通过Web服务器发送请求。Web服务器会通过循环机制算法定向到众多后端服务器中的任何一个，后端服务器再将响应通过Web服务器发送回客户端。因此此时，客户端并不知道与之交互的是哪个后端服务器。</p> <h4 id="负载均衡"><a href="#负载均衡" class="header-anchor">#</a> 负载均衡</h4> <p>另一个新术语，但是这个术语更容易理解，因为它是反向代理的一个应用实例。</p> <p>首先来谈谈<strong>负载均衡</strong>和<strong>反向代理</strong>的基本区别：在负载均衡中，您必须具有2个或更多后端服务器，但是在反向代理设置中，这不是必需的，它甚至可以与1台后端服务器一起使用。</p> <p>从幕后看一下，如果我们有来自客户端的大量请求，负载均衡器将检查每个后端服务器的状态并分配请求的负载，然后将响应更快地发送给客户端。</p> <h4 id="有状态与无状态应用程序"><a href="#有状态与无状态应用程序" class="header-anchor">#</a> 有状态与无状态应用程序</h4> <p>伙计们，我保证我会马上开始Nginx代码，我们先清除所有疑惑！</p> <ul><li>有状态的应用
此应用程序存储一个附加变量，用于保存仅可用于单个服务器实例的信息。</li></ul> <p>我的意思是，假如为后端服务器server1存储了某些信息，不为服务器server2存储某些信息，那么客户端（在此为Bob）与后端服务器进行交互的时候可能不会获得所需的结果，因为它可能与server1或server2其中任何一台服务器进行交互。在这种情况下，server1允许Bob查看配置文件，而server2不允许。因此，尽管服务器阻止了数据库许多API 的调用并且速度更快，也可能在不同服务器之间导致此问题。</p> <p>（有点懵这里，看一下知乎上的解答 ———— <a href="https://zhuanlan.zhihu.com/p/65762125" target="_blank" rel="noopener noreferrer">什么是有状态应用 or 无状态应用（专业版）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</p> <ul><li>无状态应用
无状态是客户端与不同的后端服务器进行交互时时数据库中更多的API调用，但更少的问题会出现。</li></ul> <p><img src="https://user-images.githubusercontent.com/23453305/112433868-cf1aca80-8d7d-11eb-8849-c7f4573512e6.png" alt="image"></p> <p>我知道你不明白我的意思。很简单，如果我从客户端发起请求，请求通过Web服务器发送到后端服务器server1，后端服务器将向客户端提供令牌，以用于进一步的访问请求。客户端可以使用令牌将请求发送到Web服务器，Web服务器会继续将请求连同令牌一起发送到任何后端服务器，每个服务器都将提供相同的期望返回。</p> <h3 id="什么是nginx"><a href="#什么是nginx" class="header-anchor">#</a> 什么是Nginx？</h3> <p>Nginx是Web服务器，我一直在整个博客中使用术语Web服务器。老实说，它就像一个中间人。</p> <p><img src="https://user-images.githubusercontent.com/23453305/112434570-b4952100-8d7e-11eb-9060-8488a2296d92.png" alt="image"></p> <p>该图是所有我前面解释概念的组合。</p> <p>如图，我们在3001，3002，3003端口分别运行3台后端服务器，这些后端服务器使用相同的数据库并在端口5432上运行。</p> <p>现在，当一个客户端发送一个请求GET<code>/employees</code>到 https://localhost。   （端口默认为443）这个请求会基于算法到达任何一台后端服务器，获取数据库中的信息，以JSON格式发送回Web服务器（Nginx）并返回给客户端。</p> <p>如果我们使用诸如Round-Robin之类的算法，那么它的作用是：假设客户端2发送了一个请求到地址 https://localhost。 Nginx服务器首先将该请求传递给端口3000，然后将响应发送回客户端。对于另一个请求，Nginx会将请求传递给3002，依此类推。</p> <p>到此为止，您已经对Nginx是什么，Nginx的基本术语有了清楚的了解。现在，我们将继续了解其安装和配置方法。</p> <h4 id="安装过程"><a href="#安装过程" class="header-anchor">#</a> 安装过程</h4> <p>老实说，在任何系统上安装过程都非常简单。我是Mac OSX用户，因此将基于它编写命令。但是，对于ubuntu和Windows以及其他Linux发行版，将类似地进行。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$ brew install Nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>检查Nginx是否在您的系统上运行</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$ nginx 
# OR 
$ sudo nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>使用您喜欢的浏览器并打开 http://localhost:8080/。 您将看到下面的屏幕！
<img src="https://user-images.githubusercontent.com/23453305/112439999-bd88f100-8d84-11eb-9c7e-a034794371b5.png" alt="image"></p> <h4 id="基本配置设置和示例"><a href="#基本配置设置和示例" class="header-anchor">#</a> 基本配置设置和示例</h4> <p>我们将做一个例子，看看Nginx的魅力。
首先，在本地计算机上创建目录结构，如下所示：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>.
├── nginx-demo
│  ├── content
│  │  ├── first.txt
│  │  ├── index.html
│  │  └── index.md
│  └── main
│    └── index.html
└── temp-nginx
  └── outsider
    └── index.html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>我们要实现什么？</li></ul> <p>在这里，我们有两个单独的文件夹nginx-demo和temp-nginx，每个文件夹都包含静态HTML文件。我们将在公共端口上运行这两个文件夹，并设置我们喜欢的规则。</p> <p>为了对Nginx的默认配置进行更改，我们找到位于<code>usr/local/etc/nginx</code>一个文件<code>nginx.conf</code>。我的系统中有vim，因此我可以使用vim进行更改，但是您可以自由使用其他编辑器。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$ cd /usr/local/etc/nginx
$ vim nginx.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这将打开一个我真的不想使用的具有默认nginx配置的文件。因此，我通常的做法是复制此配置文件，然后对主文件进行更改。我们也会做同样的事情。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$ cp nginx.conf copy-nginx.conf
$ rm nginx.conf &amp;&amp; vim nginx.conf 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>现在将打开一个空文件，我们将为其添加配置。</li></ul> <ol><li>添加基本配置。<code>events {}</code> 通常用于表示Nginx体系的工作事件数量。在http这里用来告诉Nginx，我们将在OSI模型的第7层工作。</li></ol> <p>在此，我们告诉nginx监听端口5000，并指向主文件夹中提到的静态文件。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  http <span class="token punctuation">{</span>

     server <span class="token punctuation">{</span>
       listen <span class="token number">5000</span><span class="token punctuation">;</span>
       root <span class="token operator">/</span>path<span class="token operator">/</span>to<span class="token operator">/</span>nginx<span class="token operator">-</span>demo<span class="token operator">/</span>main<span class="token operator">/</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>

  <span class="token punctuation">}</span>

  events <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ol start="2"><li>接下来，我们将为<code>/content</code>和<code>/outsider</code> URL添加其他规则，其中，<code>outsider</code>将指向第一步中提到的根目录之外的目录。</li></ol> <p>此处<code>location /content</code>表示无论我在子目录中为此定义哪个根，<code>content</code>子URL都将添加到所定义的根URL的末尾。因此，这里我指定根为<code>root/path/to/nginx-demo/</code>，只是意味着我要告诉Nginx，http://localhost:5000/path/to/nginx-demo/content/ 向我展示文件夹中静态文件的内容。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  http <span class="token punctuation">{</span>

    server <span class="token punctuation">{</span>
        listen <span class="token number">5000</span><span class="token punctuation">;</span>
        root <span class="token operator">/</span>path<span class="token operator">/</span>to<span class="token operator">/</span>nginx<span class="token operator">-</span>demo<span class="token operator">/</span>main<span class="token operator">/</span><span class="token punctuation">;</span> 

        location <span class="token operator">/</span>content <span class="token punctuation">{</span>
            root <span class="token operator">/</span>path<span class="token operator">/</span>to<span class="token operator">/</span>nginx<span class="token operator">-</span>demo<span class="token operator">/</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>   

        location <span class="token operator">/</span>outsider <span class="token punctuation">{</span>
           root <span class="token operator">/</span>path<span class="token operator">/</span>temp<span class="token operator">-</span>nginx<span class="token operator">/</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

  <span class="token punctuation">}</span>

  events <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>现在Nginx不仅可以定义URL根，而且还可以设置规则，以便阻止客户端访问某些文件。</strong>
3. 我们将在定义的主服务器中编写一条附加规则，以阻止访问任何.md文件。我们可以在Nginx中使用正则表达式，因此我们将规则定义如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>   location <span class="token operator">~</span> <span class="token punctuation">.</span>md <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">403</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="4"><li><code>proxy_pass</code>：我们定义在端口8888上运行的另一个后端服务器，现在我们有2个在端口5000和8888上在运行后端服务器。</li></ol> <p>我们要做的是，当客户端通过Nginx访问端口8888时，我们会将请求传递到端口5000，并将响应发送回客户端！</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>   server <span class="token punctuation">{</span>
       listen <span class="token number">8888</span><span class="token punctuation">;</span>

       location <span class="token operator">/</span> <span class="token punctuation">{</span>
           proxy_pass http<span class="token operator">:</span><span class="token operator">/</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">localhost:5000</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>

       location <span class="token operator">/</span><span class="token keyword">new</span> <span class="token punctuation">{</span>
           proxy_pass http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">5000</span><span class="token operator">/</span>outsider<span class="token operator">/</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="完整代码"><a href="#完整代码" class="header-anchor">#</a> 完整代码</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>   http <span class="token punctuation">{</span>

        server <span class="token punctuation">{</span>
            listen <span class="token number">5000</span><span class="token punctuation">;</span>
            root <span class="token operator">/</span>path<span class="token operator">/</span>to<span class="token operator">/</span>nginx<span class="token operator">-</span>demo<span class="token operator">/</span>main<span class="token operator">/</span><span class="token punctuation">;</span> 

            location <span class="token operator">/</span>content <span class="token punctuation">{</span>
                root <span class="token operator">/</span>path<span class="token operator">/</span>to<span class="token operator">/</span>nginx<span class="token operator">-</span>demo<span class="token operator">/</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>   

            location <span class="token operator">/</span>outsider <span class="token punctuation">{</span>
               root <span class="token operator">/</span>path<span class="token operator">/</span>temp<span class="token operator">-</span>nginx<span class="token operator">/</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

                    location <span class="token operator">~</span> <span class="token punctuation">.</span>md <span class="token punctuation">{</span>
              <span class="token keyword">return</span> <span class="token number">403</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>

         server <span class="token punctuation">{</span>
           listen <span class="token number">8888</span><span class="token punctuation">;</span>

           location <span class="token operator">/</span> <span class="token punctuation">{</span>
               proxy_pass http<span class="token operator">:</span><span class="token operator">/</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">localhost:5000</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span>

           location <span class="token operator">/</span><span class="token keyword">new</span> <span class="token punctuation">{</span>
               proxy_pass http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">5000</span><span class="token operator">/</span>outsider<span class="token operator">/</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

   <span class="token punctuation">}</span>

   events <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h3 id="其他nginx命令"><a href="#其他nginx命令" class="header-anchor">#</a> 其他Nginx命令！</h3> <ul><li>首次启动Nginx Web服务器。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>  $ nginx 
  #OR 
  $ sudo nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>重新加载正在运行的Nginx Web服务器。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>  $ nginx -s reload
  #OR 
  $ sudo nginx -s reload
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>停止正在运行的Nginx Web服务器。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>$ nginx -s stop
  #OR 
$ sudo nginx -s stop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>要了解Nginx的哪些进程正在您的系统上运行。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>$ ps -ef | grep Nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>第四个命令很重要，当前三个命令可能导致错误时，通常可以使用第四个命令查找所有正在运行的Nginx进程并杀死该进程，然后重新启动它。</p> <ul><li>要终止进程，您需要使用PID，可以使用以下命令终止它：</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>$ kill -9 &lt;PID&gt;
#OR 
$ sudo kill -9 &lt;PID&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>【完】</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">6/24/2021, 10:38:04 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/translation/category.html" class="prev">
        目录预览
      </a></span> <span class="next"><a href="/docs/translation/callstack.html">
        通过两个示例来解释递归和和调用堆栈
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.7276380a.js" defer></script><script src="/docs/assets/js/2.d55b7ed5.js" defer></script><script src="/docs/assets/js/27.0e98421d.js" defer></script>
  </body>
</html>
